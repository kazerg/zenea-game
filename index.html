<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Juego de Plataformas</title>
  <style>
    canvas {
      background: #87ceeb; /* Cielo azul */
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="450"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// === CONFIGURACIÓN DEL JUGADOR ===
const player = {
  x: 100,
  y: 0,
  width: 50,
  height: 50,
  velX: 0,
  velY: 0,
  speed: 5,
  jumpPower: 15,
  grounded: false,
  sprite: new Image(),
  frame: 0,
  frameWidth: 48,
  frameHeight: 48,
  frameCount: 4
};
player.sprite.src = "sprites/player.png"; // tu hoja de sprites

// === PLATAFORMAS ===
const platforms = [
  {x: 0, y: 400, width: 800, height: 50}, // suelo
  {x: 200, y: 300, width: 100, height: 20},
  {x: 400, y: 250, width: 100, height: 20}
];

// === FÍSICAS ===
const gravity = 0.8;
const friction = 0.8;

// === INPUT ===
const keys = {};

document.addEventListener("keydown", e => keys[e.code] = true);
document.addEventListener("keyup", e => keys[e.code] = false);

// === LOOP PRINCIPAL ===
function gameLoop() {
  // Movimiento lateral
  if (keys["ArrowRight"]) player.velX = player.speed;
  else if (keys["ArrowLeft"]) player.velX = -player.speed;
  else player.velX *= friction;

  // Salto
  if (keys["Space"] && player.grounded) {
    player.velY = -player.jumpPower;
    player.grounded = false;
  }

  // Aplicar gravedad
  player.velY += gravity;

  // Actualizar posición
  player.x += player.velX;
  player.y += player.velY;

  // Comprobar colisiones
  player.grounded = false;
  for (let plat of platforms) {
    if (player.x < plat.x + plat.width &&
        player.x + player.width > plat.x &&
        player.y < plat.y + plat.height &&
        player.y + player.height > plat.y) {
      
      // Colisión por arriba
      if (player.velY >= 0) {
        player.y = plat.y - player.height;
        player.velY = 0;
        player.grounded = true;
      }
    }
  }

  // === RENDERIZADO ===
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Dibujar plataformas
  ctx.fillStyle = "#654321";
  for (let plat of platforms) {
    ctx.fillRect(plat.x, plat.y, plat.width, plat.height);
  }

  // Animar y dibujar jugador
  let frameX = (player.frame % player.frameCount) * player.frameWidth;
  ctx.drawImage(
    player.sprite,
    frameX, 0, player.frameWidth, player.frameHeight,
    player.x, player.y, player.width, player.height
  );

  // Ciclo de frames
  if (keys["ArrowLeft"] || keys["ArrowRight"]) {
    player.frame++;
  } else {
    player.frame = 0;
  }

  requestAnimationFrame(gameLoop);
}

// Iniciar juego
gameLoop();
</script>
</body>
</html>
